<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Affichage Horaire</title>
</head>
<body>


<h2>Choix parametres</h2>
<select id="listeSemaines"></select>








<script>
async function chercherListeSemaine(){
    try {
        const resp=await fetch('https://testcalendrier.herokuapp.com/api/v1/semaines');
        const donnee = await resp.json();
        return JSON.parse(JSON.stringify(donnee));
    } catch (err) {
        console.log(err);
    }
}

async function chercherHoraire(choixsemaine){
    console.log(choixsemaine)
    try {
        const resp=await fetch('https://testcalendrier.herokuapp.com/api/v1/horaires',
          {
            method: 'POST',
            body: {choixsemaine}
           }
        );
        const donnee = await resp.json();
        return JSON.parse(JSON.stringify(donnee));
    } catch (err) {
        console.log(err);
    }
}
async function handleSelectChange(event) {
    console.log(event)
    const resp = await chercherHoraire(event.target.value);
    console.log(resp);
}

(async () => {

const resp=await chercherListeSemaine();
console.log(resp);
const selectListeSemaines=document.getElementById("listeSemaines");
selectListeSemaines.addEventListener("change", async (event) => handleSelectChange(event));

const choix = resp.choixSemaines;
let options=`<option value="000">000</option>`;
for(const c of choix) {
    const nvelleOption = `<option value="${c['idtablehoraire']}">${c['idtablehoraire']}</option>`;
    options = options + nvelleOption;
}

console.log(options);
selectListeSemaines.innerHTML = options;
})()

</script>



</body>
</html>